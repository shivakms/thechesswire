(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4089],{112:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(219).A)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},208:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(219).A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},2423:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>y});var a=t(3049),r=t(4205),l=t(5729),n=t(5653),i=t(208),c=t(5312),o=t(112),d=t(9062),m=t(1573),x=t(6796),h=t(7899),u=t(4005),p=t(6693);let w=h.Ik({password:h.Yj().min(12,"Password must be at least 12 characters").regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])/,"Password must contain uppercase, lowercase, number, and special character"),confirmPassword:h.Yj()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});function y(){let[e,s]=(0,r.useState)(!1),[t,h]=(0,r.useState)(!1),[y,f]=(0,r.useState)(!1),[j,g]=(0,r.useState)(!1),b=(0,u.useSearchParams)().get("token"),{register:N,handleSubmit:v,formState:{errors:k},watch:P}=(0,m.mN)({resolver:(0,x.u)(w)}),A=P("password");(0,r.useEffect)(()=>{b||(p.Ay.error("Invalid reset link"),window.location.href="/auth/forgot-password")},[b]);let S=async e=>{if(b){f(!0);try{let s=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:b,password:e.password})});if(s.ok)g(!0),p.Ay.success("Password reset successfully!");else{let e=await s.json();p.Ay.error(e.message||"Password reset failed")}}catch(e){p.Ay.error("Password reset failed")}finally{f(!1)}}},C=(e=>{if(!e)return{score:0,label:"",color:""};let s=0;return e.length>=12&&s++,/[a-z]/.test(e)&&s++,/[A-Z]/.test(e)&&s++,/\d/.test(e)&&s++,/[@$!%*?&]/.test(e)&&s++,{score:Math.min(s,4),label:["Very Weak","Weak","Fair","Good","Strong"][s-1]||"",color:["text-red-400","text-orange-400","text-yellow-400","text-blue-400","text-green-400"][s-1]||""}})(A);return j?(0,a.jsx)("div",{className:"min-h-screen chess-gradient-dark flex items-center justify-center p-4",children:(0,a.jsx)("div",{className:"w-full max-w-md",children:(0,a.jsxs)(l.P.div,{className:"glass-morphism-dark rounded-2xl p-8 shadow-2xl",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)(l.P.div,{className:"w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},children:(0,a.jsx)(n.A,{className:"w-10 h-10 text-green-400"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-white mb-2",children:"Password Reset Successfully!"}),(0,a.jsx)("p",{className:"text-gray-300",children:"Your password has been updated. You can now log in with your new password."})]}),(0,a.jsx)(l.P.div,{className:"space-y-3",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:(0,a.jsx)("button",{onClick:()=>window.location.href="/auth/gateway",className:"w-full bg-gradient-to-r from-primary-500 to-accent-500 text-white font-semibold py-3 rounded-lg hover:from-primary-600 hover:to-accent-600 transition-all duration-300 glow-effect",children:"Continue to Login"})})]})})}):(0,a.jsx)("div",{className:"min-h-screen chess-gradient-dark flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"w-full max-w-md",children:[(0,a.jsxs)(l.P.div,{className:"glass-morphism-dark rounded-2xl p-8 shadow-2xl",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)(l.P.div,{className:"w-16 h-16 bg-primary-500 rounded-full flex items-center justify-center mx-auto mb-4 glow-effect",whileHover:{scale:1.1},children:(0,a.jsx)(i.A,{className:"w-8 h-8 text-white"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-white mb-2",children:"Reset Your Password"}),(0,a.jsx)("p",{className:"text-gray-300",children:"Enter your new password below. Make sure it's strong and secure."})]}),(0,a.jsxs)("form",{onSubmit:v(S),className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"New Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(i.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,a.jsx)("input",{type:e?"text":"password",...N("password"),className:"w-full pl-10 pr-12 py-3 bg-gray-800 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter your new password"}),(0,a.jsx)("button",{type:"button",onClick:()=>s(!e),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white",children:e?(0,a.jsx)(c.A,{className:"w-5 h-5"}):(0,a.jsx)(o.A,{className:"w-5 h-5"})})]}),k.password&&(0,a.jsx)("p",{className:"text-red-400 text-sm mt-1",children:k.password.message}),A&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("div",{className:"flex space-x-1 mb-1",children:[1,2,3,4,5].map(e=>(0,a.jsx)("div",{className:"h-1 flex-1 rounded-full ".concat(e<=C.score?C.color.replace("text-","bg-"):"bg-gray-600")},e))}),(0,a.jsx)("p",{className:"text-xs ".concat(C.color),children:C.label})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Confirm New Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(i.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,a.jsx)("input",{type:t?"text":"password",...N("confirmPassword"),className:"w-full pl-10 pr-12 py-3 bg-gray-800 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Confirm your new password"}),(0,a.jsx)("button",{type:"button",onClick:()=>h(!t),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white",children:t?(0,a.jsx)(c.A,{className:"w-5 h-5"}):(0,a.jsx)(o.A,{className:"w-5 h-5"})})]}),k.confirmPassword&&(0,a.jsx)("p",{className:"text-red-400 text-sm mt-1",children:k.confirmPassword.message})]}),(0,a.jsxs)("div",{className:"p-4 bg-gray-800/50 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-white mb-2",children:"Password Requirements:"}),(0,a.jsxs)("ul",{className:"text-xs text-gray-300 space-y-1",children:[(0,a.jsxs)("li",{className:"flex items-center space-x-2 ".concat(A.length>=12?"text-green-400":""),children:[(0,a.jsx)("span",{children:"✓"}),(0,a.jsx)("span",{children:"At least 12 characters"})]}),(0,a.jsxs)("li",{className:"flex items-center space-x-2 ".concat(/[a-z]/.test(A)?"text-green-400":""),children:[(0,a.jsx)("span",{children:"✓"}),(0,a.jsx)("span",{children:"One lowercase letter"})]}),(0,a.jsxs)("li",{className:"flex items-center space-x-2 ".concat(/[A-Z]/.test(A)?"text-green-400":""),children:[(0,a.jsx)("span",{children:"✓"}),(0,a.jsx)("span",{children:"One uppercase letter"})]}),(0,a.jsxs)("li",{className:"flex items-center space-x-2 ".concat(/\d/.test(A)?"text-green-400":""),children:[(0,a.jsx)("span",{children:"✓"}),(0,a.jsx)("span",{children:"One number"})]}),(0,a.jsxs)("li",{className:"flex items-center space-x-2 ".concat(/[@$!%*?&]/.test(A)?"text-green-400":""),children:[(0,a.jsx)("span",{children:"✓"}),(0,a.jsx)("span",{children:"One special character (@$!%*?&)"})]})]})]}),(0,a.jsx)(l.P.button,{type:"submit",disabled:y,className:"w-full bg-gradient-to-r from-primary-500 to-accent-500 text-white font-semibold py-3 rounded-lg hover:from-primary-600 hover:to-accent-600 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed glow-effect",whileHover:{scale:1.02},whileTap:{scale:.98},children:y?(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,a.jsx)(l.P.div,{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),(0,a.jsx)("span",{children:"Resetting Password..."})]}):"Reset Password"})]}),(0,a.jsx)(l.P.div,{className:"mt-8 text-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:(0,a.jsxs)("button",{onClick:()=>window.location.href="/auth/gateway",className:"text-primary-400 hover:text-primary-300 font-medium flex items-center justify-center mx-auto",children:[(0,a.jsx)(d.A,{className:"w-4 h-4 mr-2"}),"Back to Login"]})})]}),(0,a.jsx)(l.P.div,{className:"mt-6 text-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:(0,a.jsx)("p",{className:"text-gray-400 text-xs",children:"\uD83D\uDD10 Your new password will be encrypted and stored securely."})})]})})}},4005:(e,s,t)=>{"use strict";var a=t(4913);t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},5312:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(219).A)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},5653:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(219).A)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},5905:(e,s,t)=>{Promise.resolve().then(t.bind(t,2423))},9062:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(219).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])}},e=>{e.O(0,[1327,6693,7072,6562,8036,7358],()=>e(e.s=5905)),_N_E=e.O()}]);