(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8985],{599:(e,a,t)=>{"use strict";t.d(a,{g:()=>i});var s=t(4205),l=t(6693);function i(){let[e,a]=(0,s.useState)(!1),[t,i]=(0,s.useState)(!1),[r,n]=(0,s.useState)(null);return{playNarration:(0,s.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"calm";try{a(!0),i(!1),r&&(r.pause(),r.currentTime=0);let s=await fetch("/api/voice/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,voiceMode:t,voiceId:"PmypFHWgqk9ACZdL8ugT"})});if(!s.ok)throw Error("Failed to generate voice narration");let o=await s.blob(),c=URL.createObjectURL(o),d=new Audio(c);d.volume=.7,d.addEventListener("ended",()=>{i(!1),URL.revokeObjectURL(c)}),d.addEventListener("error",e=>{console.error("Audio playback error:",e),i(!1),a(!1),l.Ay.error("Failed to play voice narration"),URL.revokeObjectURL(c)}),n(d),await d.play(),i(!0),a(!1)}catch(t){if(console.error("Voice narration error:",t),a(!1),i(!1),l.Ay.error("Failed to generate voice narration"),"speechSynthesis"in window){let a=new SpeechSynthesisUtterance(e);a.rate=.9,a.pitch=1.1,a.volume=.7,a.onstart=()=>i(!0),a.onend=()=>i(!1),a.onerror=()=>{i(!1),l.Ay.error("Voice narration failed")},speechSynthesis.speak(a)}}},[r]),stopNarration:(0,s.useCallback)(()=>{r&&(r.pause(),r.currentTime=0,i(!1)),"speechSynthesis"in window&&(speechSynthesis.cancel(),i(!1))},[r]),isLoading:e,isPlaying:t}}},1752:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(219).A)("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]])},3126:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(219).A)("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]])},3845:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>u});var s=t(3049),l=t(4205),i=t(5729),r=t(3126),n=t(4440),o=t(9283),c=t(3133),d=t(1752),h=t(1262),x=t(5687),p=t(4441),m=t(4734),y=t(599);function g(e){let{position:a,size:t=400}=e,l=a.split(" ")[0].split("/"),r=(e,a,t,l)=>{let r=String.fromCharCode(97+l)+(8-t);return(0,s.jsx)(i.P.div,{className:"w-12 h-12 flex items-center justify-center text-2xl ".concat(a?"bg-amber-100":"bg-amber-800"),whileHover:{scale:1.05},whileTap:{scale:.95},children:e&&(0,s.jsx)("span",{className:"select-none",children:n(e)})},r)},n=e=>({k:"♔",q:"♕",r:"♖",b:"♗",n:"♘",p:"♙",K:"♚",Q:"♛",R:"♜",B:"♝",N:"♞",P:"♟"})[e]||e,o=(e,a,t)=>{let s=e[a];if(!s)return"";let l=0;for(let e=0;e<s.length;e++){let a=s[e];if(a>="1"&&a<="8")l+=parseInt(a);else{if(l===t)return a;l++}}return""};return(0,s.jsx)(i.P.div,{className:"inline-grid grid-cols-8 border-2 border-gray-600 rounded-lg overflow-hidden shadow-2xl",style:{width:t,height:t},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5},children:(()=>{let e=[];for(let a=0;a<8;a++)for(let t=0;t<8;t++){let s=(a+t)%2==0,i=o(l,a,t);e.push(r(i,s,a,t))}return e})()})}function u(){let[e,a]=(0,l.useState)(new m.d$),[t,u]=(0,l.useState)([]),[v,w]=(0,l.useState)(-1),[b,f]=(0,l.useState)(!1),[j,N]=(0,l.useState)(""),[k,A]=(0,l.useState)(!1),[P,C]=(0,l.useState)(null),T=(0,l.useRef)(null),{playNarration:S}=(0,y.g)(),L=e=>{try{let t=new m.d$;t.loadPgn(e);let s=[],l=t.history({verbose:!0});l.forEach((e,a)=>{let t=new m.d$;for(let e=0;e<=a;e++)t.move(l[e]);s.push({move:e.lan,san:e.san,fen:t.fen()})}),a(t),u(s),w(-1),N(e),H(s)}catch(e){console.error("Error loading PGN:",e)}},H=e=>{0!==e.length&&S("I'm analyzing a chess game with ".concat(e.length," moves. This appears to be a ").concat(e.length<20?"short":e.length<40?"medium":"long"," game. Let me walk you through the key moments."),"calm")},R=e=>{if(!(e<-1)&&!(e>=t.length))if(w(e),-1===e)a(new m.d$);else{let s=new m.d$;for(let a=0;a<=e;a++)s.move(t[a].move);a(s)}},O=()=>{if(v>=t.length-1)return void f(!1);R(v+1),b&&setTimeout(()=>O(),2e3)},U=async()=>{A(!0);try{let a=await fetch("/api/chess/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fen:e.fen()})});if(a.ok){let e=await a.json();C(e);let t="Position analysis complete. The evaluation is ".concat(e.evaluation,", and the best move is ").concat(e.bestMove,". ").concat(e.comment);S(t,"expressive")}}catch(e){console.error("Analysis failed:",e)}finally{A(!1)}};return(0,s.jsx)("div",{className:"min-h-screen chess-gradient-dark p-4",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsxs)(i.P.div,{className:"text-center mb-8",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-white mb-4",children:"PGN Analysis"}),(0,s.jsx)("p",{className:"text-xl text-gray-300",children:"Upload and analyze your chess games with AI insights"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,s.jsx)("div",{className:"lg:col-span-2",children:(0,s.jsxs)(i.P.div,{className:"glass-morphism-dark rounded-2xl p-6",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Game Board"}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)(i.P.button,{onClick:U,disabled:k,className:"px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 disabled:opacity-50 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},children:k?"Analyzing...":"Analyze"}),(0,s.jsx)(i.P.button,{onClick:()=>S("Current position analysis. The position is "+(e.isCheck()?"in check":"normal")+".","calm"),className:"px-4 py-2 bg-accent-500 text-white rounded-lg hover:bg-accent-600 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,s.jsx)(r.A,{className:"w-4 h-4"})})]})]}),(0,s.jsx)("div",{className:"flex justify-center mb-6",children:(0,s.jsx)(g,{position:e.fen()})}),P&&(0,s.jsxs)(i.P.div,{className:"bg-gray-800 rounded-lg p-4 mb-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"Position Analysis"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Evaluation:"}),(0,s.jsx)("span",{className:"text-white ml-2",children:P.evaluation})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Best Move:"}),(0,s.jsx)("span",{className:"text-white ml-2",children:P.bestMove})]})]}),(0,s.jsx)("p",{className:"text-gray-300 mt-2",children:P.comment})]}),(0,s.jsxs)("div",{className:"flex justify-center items-center space-x-4",children:[(0,s.jsx)(i.P.button,{onClick:()=>R(-1),className:"p-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors",whileHover:{scale:1.1},whileTap:{scale:.9},children:(0,s.jsx)(n.A,{className:"w-5 h-5"})}),(0,s.jsx)(i.P.button,{onClick:()=>R(v-1),disabled:v<=-1,className:"p-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 disabled:opacity-50 transition-colors",whileHover:{scale:1.1},whileTap:{scale:.9},children:(0,s.jsx)(n.A,{className:"w-5 h-5"})}),(0,s.jsx)(i.P.button,{onClick:()=>{b?f(!1):(f(!0),O())},className:"p-3 bg-primary-500 text-white rounded-full hover:bg-primary-600 transition-colors",whileHover:{scale:1.1},whileTap:{scale:.9},children:b?(0,s.jsx)(o.A,{className:"w-6 h-6"}):(0,s.jsx)(c.A,{className:"w-6 h-6"})}),(0,s.jsx)(i.P.button,{onClick:()=>R(v+1),disabled:v>=t.length-1,className:"p-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 disabled:opacity-50 transition-colors",whileHover:{scale:1.1},whileTap:{scale:.9},children:(0,s.jsx)(d.A,{className:"w-5 h-5"})}),(0,s.jsx)(i.P.button,{onClick:()=>R(t.length-1),className:"p-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors",whileHover:{scale:1.1},whileTap:{scale:.9},children:(0,s.jsx)(d.A,{className:"w-5 h-5"})})]})]})}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(i.P.div,{className:"glass-morphism-dark rounded-2xl p-6",initial:{opacity:0,x:20},animate:{opacity:1,x:0},children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Upload PGN"}),(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-600 rounded-lg p-8 text-center hover:border-primary-500 transition-colors cursor-pointer",onDragOver:e=>{e.preventDefault()},onDrop:e=>{e.preventDefault();let a=e.dataTransfer.files[0];if(a&&a.name.endsWith(".pgn")){let e=new FileReader;e.onload=e=>{var a;L(null==(a=e.target)?void 0:a.result)},e.readAsText(a)}},onClick:()=>{var e;return null==(e=T.current)?void 0:e.click()},children:[(0,s.jsx)(h.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-300 mb-2",children:"Drop PGN file here or click to browse"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Supports .pgn files"}),(0,s.jsx)("input",{ref:T,type:"file",accept:".pgn",onChange:e=>{var a;let t=null==(a=e.target.files)?void 0:a[0];if(t){let e=new FileReader;e.onload=e=>{var a;L(null==(a=e.target)?void 0:a.result)},e.readAsText(t)}},className:"hidden"})]}),(0,s.jsx)("textarea",{value:j,onChange:e=>N(e.target.value),placeholder:"Or paste PGN text here...",className:"w-full mt-4 p-3 bg-gray-800 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500",rows:6}),(0,s.jsx)(i.P.button,{onClick:()=>L(j),disabled:!j.trim(),className:"w-full mt-4 px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 disabled:opacity-50 transition-colors",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Load Game"})]}),(0,s.jsxs)(i.P.div,{className:"glass-morphism-dark rounded-2xl p-6",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Move List"}),0===t.length?(0,s.jsx)("p",{className:"text-gray-400 text-center py-8",children:"No moves loaded"}):(0,s.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:t.map((e,a)=>(0,s.jsx)(i.P.button,{onClick:()=>R(a),className:"w-full p-3 rounded-lg text-left transition-colors ".concat(v===a?"bg-primary-500 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),whileHover:{scale:1.02},whileTap:{scale:.98},children:(0,s.jsxs)("span",{className:"font-mono",children:[Math.floor(a/2)+1,".",a%2==0?"":".."," ",e.san]})},a))})]}),(0,s.jsxs)(i.P.div,{className:"glass-morphism-dark rounded-2xl p-6",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.4},children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Export & Share"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)(i.P.button,{onClick:()=>{let a=new Blob([e.pgn()],{type:"text/plain"}),t=URL.createObjectURL(a),s=document.createElement("a");s.href=t,s.download="game.pgn",s.click(),URL.revokeObjectURL(t)},className:"w-full flex items-center justify-center space-x-2 px-4 py-2 bg-accent-500 text-white rounded-lg hover:bg-accent-600 transition-colors",whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,s.jsx)(x.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Export PGN"})]}),(0,s.jsxs)(i.P.button,{onClick:()=>{navigator.share?navigator.share({title:"Chess Game Analysis",text:"Check out this chess game analysis on TheChessWire.news",url:window.location.href}):navigator.clipboard.writeText(window.location.href)},className:"w-full flex items-center justify-center space-x-2 px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,s.jsx)(p.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Share Game"})]})]})]})]})]})]})})}},4440:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(219).A)("SkipBack",[["polygon",{points:"19 20 9 12 19 4 19 20",key:"o2sva"}],["line",{x1:"5",x2:"5",y1:"19",y2:"5",key:"1ocqjk"}]])},4441:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(219).A)("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]])},5687:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(219).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},9168:(e,a,t)=>{Promise.resolve().then(t.bind(t,3845))}},e=>{e.O(0,[1327,6693,8563,6562,8036,7358],()=>e(e.s=9168)),_N_E=e.O()}]);