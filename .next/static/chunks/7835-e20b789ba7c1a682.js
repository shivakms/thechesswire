"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7835],{112:(e,r,s)=>{s.d(r,{A:()=>i});let i=(0,s(219).A)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},219:(e,r,s)=>{s.d(r,{A:()=>o});var i=s(4205);let t=function(){for(var e=arguments.length,r=Array(e),s=0;s<e;s++)r[s]=arguments[s];return r.filter((e,r,s)=>!!e&&s.indexOf(e)===r).join(" ")};var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,i.forwardRef)((e,r)=>{let{color:s="currentColor",size:n=24,strokeWidth:o=2,absoluteStrokeWidth:c,className:l="",children:u,iconNode:d,...m}=e;return(0,i.createElement)("svg",{ref:r,...a,width:n,height:n,stroke:s,strokeWidth:c?24*Number(o)/Number(n):o,className:t("lucide",l),...m},[...d.map(e=>{let[r,s]=e;return(0,i.createElement)(r,s)}),...Array.isArray(u)?u:[u]])}),o=(e,r)=>{let s=(0,i.forwardRef)((s,a)=>{let{className:o,...c}=s;return(0,i.createElement)(n,{ref:a,iconNode:r,className:t("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),o),...c})});return s.displayName="".concat(e),s}},2388:(e,r,s)=>{s.d(r,{A:()=>u});var i=s(4205),t=function(e){return e.FREE_USER="free_user",e.PREMIUM_USER="premium_user",e.TITLED_PLAYER="titled_player",e.CONTENT_CREATOR="content_creator",e.ADMIN="admin",e.SUPER_ADMIN="super_admin",e}({});let a={FREE_DASHBOARDS:["main-dashboard","memory-archive","personalization","analytics"],PREMIUM_DASHBOARDS:["main-dashboard","memory-archive","personalization","analytics","soulcinema","echosage","voice-narration"],TITLED_PLAYER_DASHBOARDS:["main-dashboard","memory-archive","personalization","analytics","soulcinema","echosage","voice-narration","earnings","premium-infrastructure"],CONTENT_CREATOR_DASHBOARDS:["main-dashboard","memory-archive","personalization","analytics","soulcinema","echosage","voice-narration","social-media","social-virality","earnings"],ADMIN_DASHBOARDS:["main-dashboard","memory-archive","personalization","analytics","soulcinema","echosage","voice-narration","social-media","social-virality","earnings","premium-infrastructure","security","user-management","system-monitoring","content-moderation","revenue-analytics"],SUPER_ADMIN_DASHBOARDS:["main-dashboard","memory-archive","personalization","analytics","soulcinema","echosage","voice-narration","social-media","social-virality","earnings","premium-infrastructure","security","user-management","system-monitoring","content-moderation","revenue-analytics","admin-panel","database-management","api-management","deployment-control","backup-restore","system-logs","performance-monitoring","security-audit","crisis-management"]},n={email:"thechesswirenews@gmail.com",password:"super-admin-secure-password-2024",role:t.SUPER_ADMIN,id:"super-admin-001"},o={email:"admin@chesswire.com",password:"admin-secure-password-2024",role:t.ADMIN,id:"admin-001"};class c{initializeUsers(){this.users.set(n.id,{id:n.id,email:n.email,role:n.role,isVerified:!0,isActive:!0,lastLogin:new Date,ipAddress:"",userAgent:""}),this.users.set(o.id,{id:o.id,email:o.email,role:o.role,isVerified:!0,isActive:!0,lastLogin:new Date,ipAddress:"",userAgent:""})}async login(e,r,s,i){try{if(e===n.email&&r===n.password){let r=this.users.get(n.id);if(!r)return{success:!1,error:"Super Admin account not found"};r.lastLogin=new Date,r.ipAddress=s,r.userAgent=i;let t=this.generateSecureToken(),a={userId:r.id,role:r.role,token:t,expiresAt:new Date(Date.now()+864e5),ipAddress:s,userAgent:i};return this.sessions.set(t,a),console.log("\uD83D\uDD10 Super Admin login successful:",{email:e,ipAddress:s,userAgent:i}),{success:!0,user:r,token:t}}if(e===o.email&&r===o.password){let r=this.users.get(o.id);if(!r)return{success:!1,error:"Admin account not found"};r.lastLogin=new Date,r.ipAddress=s,r.userAgent=i;let t=this.generateSecureToken(),a={userId:r.id,role:r.role,token:t,expiresAt:new Date(Date.now()+864e5),ipAddress:s,userAgent:i};return this.sessions.set(t,a),console.log("\uD83D\uDD10 Admin login successful:",{email:e,ipAddress:s,userAgent:i}),{success:!0,user:r,token:t}}let a={id:"demo-user-001",email:e,role:t.FREE_USER,isVerified:!0,isActive:!0,lastLogin:new Date,ipAddress:s,userAgent:i};this.users.set(a.id,a);let c=this.generateSecureToken(),l={userId:a.id,role:a.role,token:c,expiresAt:new Date(Date.now()+864e5),ipAddress:s,userAgent:i};return this.sessions.set(c,l),console.log("\uD83D\uDD10 Demo user login successful:",{email:e,role:a.role,ipAddress:s}),{success:!0,user:a,token:c}}catch(e){return console.error("❌ Login failed:",e),{success:!1,error:"Login failed"}}}async verifyToken(e,r,s){try{let i=this.sessions.get(e);if(!i)return{valid:!1,error:"Invalid session token"};if(new Date>i.expiresAt)return this.sessions.delete(e),{valid:!1,error:"Session expired"};if(i.ipAddress!==r||i.userAgent!==s)return console.warn("⚠️ Security warning: IP or User Agent mismatch for token:",e),this.sessions.delete(e),{valid:!1,error:"Security violation detected"};let t=this.users.get(i.userId);if(!t)return this.sessions.delete(e),{valid:!1,error:"User not found"};if(!t.isActive)return{valid:!1,error:"User account is inactive"};return{valid:!0,user:t}}catch(e){return console.error("❌ Token verification failed:",e),{valid:!1,error:"Token verification failed"}}}async logout(e){try{return this.sessions.delete(e),console.log("\uD83D\uDD10 User logged out successfully"),{success:!0}}catch(e){return console.error("❌ Logout failed:",e),{success:!1}}}async checkAdminAccess(e,r,s){let i,t=await this.verifyToken(e,r,s);if(!t.valid||!t.user)return{isAdmin:!1,isSuperAdmin:!1};let a=t.user,n="admin"===(i=a.role)||"super_admin"===i,o="super_admin"===a.role;return console.log("\uD83D\uDD10 Admin access check:",{email:a.email,role:a.role,isAdmin:n,isSuperAdmin:o}),{isAdmin:n,isSuperAdmin:o,user:a}}async checkDashboardAccess(e,r,s,i){var t;let n=await this.verifyToken(e,s,i);if(!n.valid||!n.user)return{canAccess:!1,error:"Invalid session"};let o=n.user,c=(t=o.role,-1!==(e=>{switch(e){case"super_admin":return a.SUPER_ADMIN_DASHBOARDS;case"admin":return a.ADMIN_DASHBOARDS;case"content_creator":return a.CONTENT_CREATOR_DASHBOARDS;case"titled_player":return a.TITLED_PLAYER_DASHBOARDS;case"premium_user":return a.PREMIUM_DASHBOARDS;default:return a.FREE_DASHBOARDS}})(t).indexOf(r));return console.log("\uD83D\uDD10 Dashboard access check:",{email:o.email,role:o.role,dashboardId:r,hasAccess:c}),{canAccess:c,user:o}}generateSecureToken(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r="";for(let s=0;s<64;s++)r+=e.charAt(Math.floor(Math.random()*e.length));return r}async getActiveSessions(){let e=[];return this.sessions.forEach((r,s)=>{new Date<r.expiresAt&&e.push(r)}),e}async getUserById(e){return this.users.get(e)||null}async updateUserRole(e,r,s,i,t){if(!(await this.checkAdminAccess(s,i,t)).isSuperAdmin)return{success:!1,error:"Only Super Admin can update user roles"};let a=this.users.get(e);return a?(a.role=r,console.log("\uD83D\uDD10 User role updated:",{userId:e,oldRole:a.role,newRole:r}),{success:!0}):{success:!1,error:"User not found"}}constructor(){this.sessions=new Map,this.users=new Map,this.initializeUsers()}}new c;let l=(0,i.createContext)(void 0);function u(){let e=(0,i.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},4674:(e,r,s)=>{s.d(r,{A:()=>i});let i=(0,s(219).A)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},7229:(e,r,s)=>{s.d(r,{A:()=>i});let i=(0,s(219).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},9850:(e,r,s)=>{s.d(r,{A:()=>i});let i=(0,s(219).A)("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]])}}]);